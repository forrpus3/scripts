local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

-- KEY SYSTEM
local CORRECT_KEY = "o.goddy"
local keyAuthenticated = false

local function createKeySystem()
	local keyGui = Instance.new("ScreenGui")
	keyGui.ResetOnSpawn = false
	keyGui.Parent = player:WaitForChild("PlayerGui")
	
	local keyFrame = Instance.new("Frame")
	keyFrame.Size = UDim2.new(0, 300, 0, 150)
	keyFrame.Position = UDim2.new(0.5, -150, 0.5, -75)
	keyFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	keyFrame.BorderSizePixel = 2
	keyFrame.BorderColor3 = Color3.fromRGB(220, 53, 69)
	keyFrame.Parent = keyGui
	
	local titleLabel = Instance.new("TextLabel")
	titleLabel.Size = UDim2.new(1, 0, 0, 40)
	titleLabel.Position = UDim2.new(0, 0, 0, 0)
	titleLabel.Text = "KEY SYSTEM"
	titleLabel.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
	titleLabel.TextColor3 = Color3.new(1, 1, 1)
	titleLabel.Font = Enum.Font.GothamBold
	titleLabel.TextSize = 18
	titleLabel.BorderSizePixel = 0
	titleLabel.Parent = keyFrame
	
	local keyBox = Instance.new("TextBox")
	keyBox.Size = UDim2.new(0.9, 0, 0, 35)
	keyBox.Position = UDim2.new(0.05, 0, 0, 50)
	keyBox.PlaceholderText = "Enter Key..."
	keyBox.Text = ""
	keyBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
	keyBox.TextColor3 = Color3.new(1, 1, 1)
	keyBox.Font = Enum.Font.Gotham
	keyBox.TextSize = 14
	keyBox.BorderSizePixel = 0
	keyBox.ClearTextOnFocus = false
	keyBox.Parent = keyFrame
	
	local submitButton = Instance.new("TextButton")
	submitButton.Size = UDim2.new(0.9, 0, 0, 35)
	submitButton.Position = UDim2.new(0.05, 0, 0, 95)
	submitButton.Text = "SUBMIT"
	submitButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
	submitButton.TextColor3 = Color3.new(1, 1, 1)
	submitButton.Font = Enum.Font.GothamBold
	submitButton.TextSize = 16
	submitButton.BorderSizePixel = 0
	submitButton.Parent = keyFrame
	
	local function checkKey()
		if keyBox.Text == CORRECT_KEY then
			keyAuthenticated = true
			keyGui:Destroy()
			initializeScript()
		else
			keyBox.Text = ""
			keyBox.PlaceholderText = "Wrong Key! Try Again..."
			submitButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
			task.wait(1)
			submitButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
			keyBox.PlaceholderText = "Enter Key..."
		end
	end
	
	submitButton.MouseButton1Click:Connect(checkKey)
	
	keyBox.FocusLost:Connect(function(enterPressed)
		if enterPressed then
			checkKey()
		end
	end)
end

function initializeScript()
	if not keyAuthenticated then return end
	
	local character, humanoid, rootPart
	
	local function bindCharacter(char)
		character = char
		humanoid = char:WaitForChild("Humanoid")
		rootPart = char:WaitForChild("HumanoidRootPart")
	end
	
	bindCharacter(player.Character or player.CharacterAdded:Wait())
	player.CharacterAdded:Connect(bindCharacter)
	
	local remotes = ReplicatedStorage:WaitForChild("Remotes")
	local promptPlayerLaunch = remotes:WaitForChild("promptPlayerLaunch")
	local topsFolder = workspace:WaitForChild("Tops")
	
	local TARGET_POSITION = Vector3.new(
		415.53619384765625,
		120.1265640258789,
		-86.57369232177734
	)
	
	local FACING_POSITION = Vector3.new(
		424.9053955078125,
		112.94845581054688,
		-72.63363647460938
	)
	
	-- ONLY CHANGE MADE HERE
	local RESPAWN_POSITION = Vector3.new(
		348.2432556152344,
		118.49895477294922,
		-125.55145263671875
	)
	
	local POSITION_RADIUS = 3
	local MOVE_RATE = 0.15
	local ROTATE_SPEED = 10
	local RESPAWN_RADIUS = 5
	local STUCK_CHECK_INTERVAL = 2
	local STUCK_DISTANCE_THRESHOLD = 2
	local UNSTUCK_OFFSET_DISTANCE = 8
	
	local isRunning = false
	local inPosition = false
	local initialFired = false
	local lastPosition = nil
	local lastMoveTime = 0
	local isUnstucking = false
	local isRecharging = false
	local noclipConnection = nil
	
	local healthConnection = nil
	local rotateConnection = nil
	local modelConnection = nil
	local energyConnection = nil
	
	local gui = Instance.new("ScreenGui")
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")
	
	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0, 180, 0, 100)
	frame.Position = UDim2.new(0.5, -90, 0.1, 0)
	frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
	frame.BorderSizePixel = 0
	frame.Active = true
	frame.Draggable = true
	frame.Parent = gui
	
	local button = Instance.new("TextButton")
	button.Size = UDim2.new(1, 0, 0, 60)
	button.Position = UDim2.new(0, 0, 0, 0)
	button.Text = "START"
	button.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
	button.TextColor3 = Color3.new(1,1,1)
	button.Font = Enum.Font.GothamBold
	button.TextSize = 18
	button.BorderSizePixel = 0
	button.Parent = frame
	
	local keyLabel = Instance.new("TextLabel")
	keyLabel.Size = UDim2.new(1, 0, 0, 35)
	keyLabel.Position = UDim2.new(0, 0, 0, 65)
	keyLabel.Text = "Press O to toggle"
	keyLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	keyLabel.TextColor3 = Color3.new(1, 1, 1)
	keyLabel.Font = Enum.Font.Gotham
	keyLabel.TextSize = 14
	keyLabel.BorderSizePixel = 0
	keyLabel.Parent = frame
	
	-- Energy monitoring system
	local function getCharacter()
		local char = player.Character or player.CharacterAdded:Wait()
		return char, char:WaitForChild("Humanoid")
	end
	
	local function getEnergyBar()
		return player.PlayerGui
			:WaitForChild("HUD")
			:WaitForChild("Main HUD")
			:WaitForChild("Energy")
			:WaitForChild("Progress")
	end
	
	local function findNearbyProximityPrompt(position, maxDistance)
		local closestPrompt = nil
		local closestDistance = maxDistance
		
		for _, obj in ipairs(workspace:GetDescendants()) do
			if obj:IsA("ProximityPrompt") and obj.Enabled then
				local parent = obj.Parent
				local promptPos = nil
				
				if parent:IsA("BasePart") then
					promptPos = parent.Position
				elseif parent:IsA("Model") then
					if parent.PrimaryPart then
						promptPos = parent.PrimaryPart.Position
					else
						local part = parent:FindFirstChildWhichIsA("BasePart", true)
						if part then
							promptPos = part.Position
						end
					end
				elseif parent:IsA("Attachment") then
					promptPos = parent.WorldPosition
				end
				
				if promptPos then
					local dist = (promptPos - position).Magnitude
					if dist < closestDistance then
						closestDistance = dist
						closestPrompt = obj
					end
				end
			end
		end
		
		return closestPrompt
	end
	
	local function fireProximityPrompt(prompt)
		if prompt then
			pcall(function()
				if fireproximityprompt then
					fireproximityprompt(prompt, 0, true)
				elseif fire_proximity_prompt then
					fire_proximity_prompt(prompt)
				else
					local oldHoldDuration = prompt.HoldDuration
					prompt.HoldDuration = 0
					prompt:InputHoldBegin()
					task.wait(0.1)
					prompt:InputHoldEnd()
					prompt.HoldDuration = oldHoldDuration
				end
			end)
		end
	end
	
	-- Start energy monitoring (check every 10 seconds)
	local function startEnergyMonitoring()
		if energyConnection then
			task.cancel(energyConnection)
		end
		
		energyConnection = task.spawn(function()
			local energyBar = getEnergyBar()
			while isRunning do
				local energy = energyBar.Size.X.Scale
				if energy <= 0 then
					isRecharging = true
					
					local reachedPosition = false
					local maxAttempts = 60
					
					for i = 1, maxAttempts do
						local _, hum = getCharacter()
						local char = player.Character
						
						if char and char:FindFirstChild("HumanoidRootPart") then
							local dist = (char.HumanoidRootPart.Position - RESPAWN_POSITION).Magnitude
							
							if dist <= RESPAWN_RADIUS then
								reachedPosition = true
								break
							else
								hum:MoveTo(RESPAWN_POSITION)
							end
						end
						
						task.wait(0.5)
					end
					
					if reachedPosition then
						task.wait(2)
						
						local char = player.Character
						if char and char:FindFirstChild("HumanoidRootPart") then
							local prompt = findNearbyProximityPrompt(RESPAWN_POSITION, 15)
							if prompt then
								fireProximityPrompt(prompt)
								task.wait(2)
							end
						end
					end
					
					isRecharging = false
				end
				task.wait(10)
			end
		end)
	end
	
	-- rest of script unchanged â€¦

end

-- Start key system on load
createKeySystem()
