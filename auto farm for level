-------------------------------------------------------------------------------
--! json library
--! cryptography library
local a=2^32;local b=a-1;local function c(d,e)local f,g=0,1;while d~=0 or e~=0 do local h,i=d%2,e%2;local j=(h+i)%2;f=f+j*g;d=math.floor(d/2)e=math.floor(e/2)g=g*2 end;return f%a end;local function k(d,e,l,...)local m;if e then d=d%a;e=e%a;m=c(d,e)if l then m=k(m,l,...)end;return m elseif d then return d%a else return 0 end end;local function n(d,e,l,...)local m;if e then d=d%a;e=e%a;m=(d+e-c(d,e))/2;if l then m=n(m,l,...)end;return m elseif d then return d%a else return b end end;local function o(p)return b-p end;local function q(d,r)if r<0 then return lshift(d,-r)end;return math.floor(d%2^32/2^r)end;local function s(p,r)if r>31 or r<-31 then return 0 end;return q(p%a,r)end;local function lshift(d,r)if r<0 then return s(d,-r)end;return d*2^r%2^32 end;local function t(p,r)p=p%a;r=r%32;local u=n(p,2^r-1)return s(p,r)+lshift(u,32-r)end;local v={0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2}local function w(x)return string.gsub(x,".",function(l)return string.format("%02x",string.byte(l))end)end;local function y(z,A)local x=""for B=1,A do local C=z%256;x=string.char(C)..x;z=(z-C)/256 end;return x end;local function D(x,B)local A=0;for B=B,B+3 do A=A*256+string.byte(x,B)end;return A end;local function E(F,G)local H=64-(G+9)%64;G=y(8*G,8)F=F.."\128"..string.rep("\0",H)..G;assert(#F%64==0)return F end;local function I(J)J[1]=0x6a09e667;J[2]=0xbb67ae85;J[3]=0x3c6ef372;J[4]=0xa54ff53a;J[5]=0x510e527f;J[6]=0x9b05688c;J[7]=0x1f83d9ab;J[8]=0x5be0cd19;return J end;local function K(F,B,J)local L={}for M=1,16 do L[M]=D(F,B+(M-1)*4)end;for M=17,64 do local N=L[M-15]local O=k(t(N,7),t(N,18),s(N,3))N=L[M-2]L[M]=(L[M-16]+O+L[M-7]+k(t(N,17),t(N,19),s(N,10)))%a end;local d,e,l,P,Q,R,S,T=J[1],J[2],J[3],J[4],J[5],J[6],J[7],J[8]for B=1,64 do local O=k(t(d,2),t(d,13),t(d,22))local U=k(n(d,e),n(d,l),n(e,l))local V=(O+U)%a;local W=k(t(Q,6),t(Q,11),t(Q,25))local X=k(n(Q,R),n(o(Q),S))local Y=(T+W+X+v[B]+L[B])%a;T=S;S=R;R=Q;Q=(P+Y)%a;P=l;l=e;e=d;d=(Y+V)%a end;J[1]=(J[1]+d)%a;J[2]=(J[2]+e)%a;J[3]=(J[3]+l)%a;J[4]=(J[4]+P)%a;J[5]=(J[5]+Q)%a;J[6]=(J[6]+R)%a;J[7]=(J[7]+S)%a;J[8]=(J[8]+T)%a end;local function Z(F)F=E(F,#F)local J=I({})for B=1,#F,64 do K(F,B,J)end;return w(y(J[1],4)..y(J[2],4)..y(J[3],4)..y(J[4],4)..y(J[5],4)..y(J[6],4)..y(J[7],4)..y(J[8],4))end;local e;local l={["\\"]="\\",["\""]="\"",["\b"]="b",["\f"]="f",["\n"]="n",["\r"]="r",["\t"]="t"}local P={["/"]="/"}for Q,R in pairs(l)do P[R]=Q end;local S=function(T)return"\\"..(l[T]or string.format("u%04x",T:byte()))end;local B=function(M)return"null"end;local v=function(M,z)local _={}z=z or{}if z[M]then error("circular reference")end;z[M]=true;if rawget(M,1)~=nil or next(M)==nil then local A=0;for Q in pairs(M)do if type(Q)~="number"then error("invalid table: mixed or invalid key types")end;A=A+1 end;if A~=#M then error("invalid table: sparse array")end;for a0,R in ipairs(M)do table.insert(_,e(R,z))end;z[M]=nil;return"["..table.concat(_,",").."]"else for Q,R in pairs(M)do if type(Q)~="string"then error("invalid table: mixed or invalid key types")end;table.insert(_,e(Q,z)..":"..e(R,z))end;z[M]=nil;return"{"..table.concat(_,",").."}"end end;local g=function(M)return'"'..M:gsub('[%z\1-\31\\"]',S)..'"'end;local a1=function(M)if M~=M or M<=-math.huge or M>=math.huge then error("unexpected number value '"..tostring(M).."'")end;return string.format("%.14g",M)end;local j={["nil"]=B,["table"]=v,["string"]=g,["number"]=a1,["boolean"]=tostring}e=function(M,z)local x=type(M)local a2=j[x]if a2 then return a2(M,z)end;error("unexpected type '"..x.."'")end;local a3=function(M)return e(M)end;local a4;local N=function(...)local _={}for a0=1,select("#",...)do _[select(a0,...)]=true end;return _ end;local L=N(" ","\t","\r","\n")local p=N(" ","\t","\r","\n","]","}",",")local a5=N("\\","/",'"',"b","f","n","r","t","u")local m=N("true","false","null")local a6={["true"]=true,["false"]=false,["null"]=nil}local a7=function(a8,a9,aa,ab)for a0=a9,#a8 do if aa[a8:sub(a0,a0)]~=ab then return a0 end end;return#a8+1 end;local ac=function(a8,a9,J)local ad=1;local ae=1;for a0=1,a9-1 do ae=ae+1;if a8:sub(a0,a0)=="\n"then ad=ad+1;ae=1 end end;error(string.format("%s at line %d col %d",J,ad,ae))end;local af=function(A)local a2=math.floor;if A<=0x7f then return string.char(A)elseif A<=0x7ff then return string.char(a2(A/64)+192,A%64+128)elseif A<=0xffff then return string.char(a2(A/4096)+224,a2(A%4096/64)+128,A%64+128)elseif A<=0x10ffff then return string.char(a2(A/262144)+240,a2(A%262144/4096)+128,a2(A%4096/64)+128,A%64+128)end;error(string.format("invalid unicode codepoint '%x'",A))end;local ag=function(ah)local ai=tonumber(ah:sub(1,4),16)local aj=tonumber(ah:sub(7,10),16)if aj then return af((ai-0xd800)*0x400+aj-0xdc00+0x10000)else return af(ai)end end;local ak=function(a8,a0)local _=""local al=a0+1;local Q=al;while al<=#a8 do local am=a8:byte(al)if am<32 then ac(a8,al,"control character in string")elseif am==92 then _=_..a8:sub(Q,al-1)al=al+1;local T=a8:sub(al,al)if T=="u"then local an=a8:match("^[dD][89aAbB]%x%x\\u%x%x%x%x",al+1)or a8:match("^%x%x%x%x",al+1)or ac(a8,al-1,"invalid unicode escape in string")_=_..ag(an)al=al+#an else if not a5[T]then ac(a8,al-1,"invalid escape char '"..T.."' in string")end;_=_..P[T]end;Q=al+1 elseif am==34 then _=_..a8:sub(Q,al-1)return _,al+1 end;al=al+1 end;ac(a8,a0,"expected closing quote for string")end;local ao=function(a8,a0)local am=a7(a8,a0,p)local ah=a8:sub(a0,am-1)local A=tonumber(ah)if not A then ac(a8,a0,"invalid number '"..ah.."'")end;return A,am end;local ap=function(a8,a0)local am=a7(a8,a0,p)local aq=a8:sub(a0,am-1)if not m[aq]then ac(a8,a0,"invalid literal '"..aq.."'")end;return a6[aq],am end;local ar=function(a8,a0)local _={}local A=1;a0=a0+1;while 1 do local am;a0=a7(a8,a0,L,true)if a8:sub(a0,a0)=="]"then a0=a0+1;break end;am,a0=a4(a8,a0)_[A]=am;A=A+1;a0=a7(a8,a0,L,true)local as=a8:sub(a0,a0)a0=a0+1;if as=="]"then break end;if as~=","then ac(a8,a0,"expected ']' or ','")end end;return _,a0 end;local at=function(a8,a0)local _={}a0=a0+1;while 1 do local au,M;a0=a7(a8,a0,L,true)if a8:sub(a0,a0)=="}"then a0=a0+1;break end;if a8:sub(a0,a0)~='"'then ac(a8,a0,"expected string for key")end;au,a0=a4(a8,a0)a0=a7(a8,a0,L,true)if a8:sub(a0,a0)~=":"then ac(a8,a0,"expected ':' after key")end;a0=a7(a8,a0+1,L,true)M,a0=a4(a8,a0)_[au]=M;a0=a7(a8,a0,L,true)local as=a8:sub(a0,a0)a0=a0+1;if as=="}"then break end;if as~=","then ac(a8,a0,"expected '}' or ','")end end;return _,a0 end;local av={['"']=ak,["0"]=ao,["1"]=ao,["2"]=ao,["3"]=ao,["4"]=ao,["5"]=ao,["6"]=ao,["7"]=ao,["8"]=ao,["9"]=ao,["-"]=ao,["t"]=ap,["f"]=ap,["n"]=ap,["["]=ar,["{"]=at}a4=function(a8,a9)local as=a8:sub(a9,a9)local a2=av[as]if a2 then return a2(a8,a9)end;ac(a8,a9,"unexpected character '"..as.."'")end;local aw=function(a8)if type(a8)~="string"then error("expected argument of type string, got "..type(a8))end;local _,a9=a4(a8,a7(a8,1,L,true))a9=a7(a8,a9,L,true)if a9<=#a8 then ac(a8,a9,"trailing garbage")end;return _ end;
local lEncode, lDecode, lDigest = a3, aw, Z;
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
--! platoboost library

--! configuration
local service = 16126;  -- your service id, this is used to identify your service.
local secret = "ac015aa8-c102-4f3d-b27c-0d6b9f3ff927";  -- make sure to obfuscate this if you want to ensure security.
local useNonce = true;  -- use a nonce to prevent replay attacks and request tampering.

--! callbacks
local onMessage = function(message) end;

--! wait for game to load
repeat task.wait(1) until game:IsLoaded();

--! functions
local requestSending = false;
local fSetClipboard, fRequest, fStringChar, fToString, fStringSub, fOsTime, fMathRandom, fMathFloor, fGetHwid = setclipboard or toclipboard, request or http_request or syn_request, string.char, tostring, string.sub, os.time, math.random, math.floor, gethwid or function() return game:GetService("Players").LocalPlayer.UserId end
local cachedLink, cachedTime = "", 0;

--! pick host
local host = "https://api.platoboost.app";
local hostResponse = fRequest({
    Url = host .. "/public/connectivity",
    Method = "GET"
});
if hostResponse.StatusCode ~= 200 or hostResponse.StatusCode ~= 429 then
    host = "https://api.platoboost.net";
end

--!optimize 2
function cacheLink()
    if cachedTime + (10*60) < fOsTime() then
        local response = fRequest({
            Url = host .. "/public/start",
            Method = "POST",
            Body = lEncode({
                service = service,
                identifier = lDigest(fGetHwid())
            }),
            Headers = {
                ["Content-Type"] = "application/json"
            }
        });

        if response.StatusCode == 200 then
            local decoded = lDecode(response.Body);

            if decoded.success == true then
                cachedLink = decoded.data.url;
                cachedTime = fOsTime();
                return true, cachedLink;
            else
                onMessage(decoded.message);
                return false, decoded.message;
            end
        elseif response.StatusCode == 429 then
            local msg = "you are being rate limited, please wait 20 seconds and try again.";
            onMessage(msg);
            return false, msg;
        end

        local msg = "Failed to cache link.";
        onMessage(msg);
        return false, msg;
    else
        return true, cachedLink;
    end
end

cacheLink();

--!optimize 2
local generateNonce = function()
    local str = ""
    for _ = 1, 16 do
        str = str .. fStringChar(fMathFloor(fMathRandom() * (122 - 97 + 1)) + 97)
    end
    return str
end

--!optimize 1
for _ = 1, 5 do
    local oNonce = generateNonce();
    task.wait(0.2)
    if generateNonce() == oNonce then
        local msg = "platoboost nonce error.";
        onMessage(msg);
        error(msg);
    end
end

--!optimize 2
local copyLink = function()
    local success, link = cacheLink();
    
    if success then
        fSetClipboard(link);
    end
end

--!optimize 2
local redeemKey = function(key)
    local nonce = generateNonce();
    local endpoint = host .. "/public/redeem/" .. fToString(service);

    local body = {
        identifier = lDigest(fGetHwid()),
        key = key
    }

    if useNonce then
        body.nonce = nonce;
    end

    local response = fRequest({
        Url = endpoint,
        Method = "POST",
        Body = lEncode(body),
        Headers = {
            ["Content-Type"] = "application/json"
        }
    });

    if response.StatusCode == 200 then
        local decoded = lDecode(response.Body);

        if decoded.success == true then
            if decoded.data.valid == true then
                if useNonce then
                    if decoded.data.hash == lDigest("true" .. "-" .. nonce .. "-" .. secret) then
                        return true;
                    else
                        onMessage("failed to verify integrity.");
                        return false;
                    end    
                else
                    return true;
                end
            else
                onMessage("key is invalid.");
                return false;
            end
        else
            if fStringSub(decoded.message, 1, 27) == "unique constraint violation" then
                onMessage("you already have an active key, please wait for it to expire before redeeming it.");
                return false;
            else
                onMessage(decoded.message);
                return false;
            end
        end
    elseif response.StatusCode == 429 then
        onMessage("you are being rate limited, please wait 20 seconds and try again.");
        return false;
    else
        onMessage("server returned an invalid status code, please try again later.");
        return false; 
    end
end

--!optimize 2
local verifyKey = function(key)
    if requestSending == true then
        onMessage("a request is already being sent, please slow down.");
        return false;
    else
        requestSending = true;
    end

    local nonce = generateNonce();
    local endpoint = host .. "/public/whitelist/" .. fToString(service) .. "?identifier=" .. lDigest(fGetHwid()) .. "&key=" .. key;

    if useNonce then
        endpoint = endpoint .. "&nonce=" .. nonce;
    end

    local response = fRequest({
        Url = endpoint,
        Method = "GET",
    });

    requestSending = false;

    if response.StatusCode == 200 then
        local decoded = lDecode(response.Body);

        if decoded.success == true then
            if decoded.data.valid == true then
                if useNonce then
                    if decoded.data.hash == lDigest("true" .. "-" .. nonce .. "-" .. secret) then
                        return true;
                    else
                        onMessage("failed to verify integrity.");
                        return false;
                    end
                else
                    return true;
                end
            else
                if fStringSub(key, 1, 4) == "KEY_" then
                    return redeemKey(key);
                else
                    onMessage("key is invalid.");
                    return false;
                end
            end
        else
            onMessage(decoded.message);
            return false;
        end
    elseif response.StatusCode == 429 then
        onMessage("you are being rate limited, please wait 20 seconds and try again.");
        return false;
    else
        onMessage("server returned an invalid status code, please try again later.");
        return false;
    end
end

--!optimize 2
local getFlag = function(name)
    local nonce = generateNonce();
    local endpoint = host .. "/public/flag/" .. fToString(service) .. "?name=" .. name;

    if useNonce then
        endpoint = endpoint .. "&nonce=" .. nonce;
    end

    local response = fRequest({
        Url = endpoint,
        Method = "GET",
    });

    if response.StatusCode == 200 then
        local decoded = lDecode(response.Body);

        if decoded.success == true then
            if useNonce then
                if decoded.data.hash == lDigest(fToString(decoded.data.value) .. "-" .. nonce .. "-" .. secret) then
                    return decoded.data.value;
                else
                    onMessage("failed to verify integrity.");
                    return nil;
                end
            else
                return decoded.data.value;
            end
        else
            onMessage(decoded.message);
            return nil;
        end
    else
        return nil;
    end
end
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
--! platoboost usage documentation
-- copyLink() -> string
-- verifyKey(key: string) -> boolean
-- getFlag(name: string) -> boolean, string | boolean | number

-- use copyLink() to copy a link to the clipboard, in which the user will paste it into their browser and complete the keysystem.
-- use verifyKey(key) to verify a key, this will return a boolean value, true means the key was valid, false means it is invalid.
-- use getFlag(name) to get a flag from the server, this will return nil if an error occurs, if no error occurs, the value configured in the platoboost dashboard will be returned.

-- IMPORTANT: onMessage is a callback, it will be called upon status update, use it to provide information to user.
-- EXAMPLE: 
--[[
onMessage = function(message)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Platoboost status",
        Text = message
    })
end
]]--

-- NOTE: PLACE THIS ENTIRE SCRIPT AT THE TOP OF YOUR SCRIPT, ADD THE LOGIC, THEN OBFUSCATE YOUR SCRIPT.

--! example usage
--[[
copyButton.MouseButton1Click:Connect(function()
    copyLink();
end)

verifyButton.MouseButton1Click:Connect(function()
    local key = keyBox.Text;
    local success = verifyKey(key);

    if success then
        print("key is valid.");
    else
        print("key is invalid.");
    end
end)

local flag = getFlag("example_flag");
if flag ~= nil then
    print("flag value: " .. flag);
else
    print("failed to get flag.");
end
]]--
-------------------------------------------------------------------------------
-- Alua Key System GUI - Enhanced Design
-- Modern premium design with smooth animations

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AluaKeySystem"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = game:GetService("CoreGui")

-- Blur Background
local blur = Instance.new("Frame")
blur.Name = "BlurBackground"
blur.Size = UDim2.new(1, 0, 1, 0)
blur.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
blur.BackgroundTransparency = 0.5
blur.BorderSizePixel = 0
blur.ZIndex = 0
blur.Parent = screenGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 480, 0, 340)
mainFrame.Position = UDim2.new(0.5, -240, 0.5, -170)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

-- Outer glow frame
local glowFrame = Instance.new("Frame")
glowFrame.Name = "GlowFrame"
glowFrame.Size = UDim2.new(1, 6, 1, 6)
glowFrame.Position = UDim2.new(0, -3, 0, -3)
glowFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
glowFrame.BorderSizePixel = 0
glowFrame.ZIndex = -1
glowFrame.Parent = mainFrame

local glowCorner = Instance.new("UICorner")
glowCorner.CornerRadius = UDim.new(0, 16)
glowCorner.Parent = glowFrame

local glowStroke = Instance.new("UIStroke")
glowStroke.Color = Color3.fromRGB(80, 140, 255)
glowStroke.Thickness = 2
glowStroke.Transparency = 0.5
glowStroke.Parent = glowFrame

-- Main corner
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 14)
corner.Parent = mainFrame

-- Gradient accent top
local accentTop = Instance.new("Frame")
accentTop.Name = "AccentTop"
accentTop.Size = UDim2.new(1, 0, 0, 3)
accentTop.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
accentTop.BorderSizePixel = 0
accentTop.Parent = mainFrame

local accentGradient = Instance.new("UIGradient")
accentGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 140, 255)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(120, 80, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(80, 140, 255))
}
accentGradient.Parent = accentTop

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 60)
titleBar.BackgroundColor3 = Color3.fromRGB(26, 26, 36)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 14)
titleCorner.Parent = titleBar

-- Logo/Icon Frame
local iconFrame = Instance.new("Frame")
iconFrame.Name = "IconFrame"
iconFrame.Size = UDim2.new(0, 36, 0, 36)
iconFrame.Position = UDim2.new(0, 20, 0, 12)
iconFrame.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
iconFrame.BorderSizePixel = 0
iconFrame.Parent = titleBar

local iconCorner = Instance.new("UICorner")
iconCorner.CornerRadius = UDim.new(0, 8)
iconCorner.Parent = iconFrame

local iconText = Instance.new("TextLabel")
iconText.Size = UDim2.new(1, 0, 1, 0)
iconText.BackgroundTransparency = 1
iconText.Text = "A"
iconText.TextColor3 = Color3.fromRGB(255, 255, 255)
iconText.TextSize = 20
iconText.Font = Enum.Font.GothamBold
iconText.Parent = iconFrame

-- Title Text
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(0, 200, 1, 0)
title.Position = UDim2.new(0, 65, 0, 0)
title.BackgroundTransparency = 1
title.Text = "ALUA KEY SYSTEM"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 18
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = titleBar

local subtitle = Instance.new("TextLabel")
subtitle.Name = "Subtitle"
subtitle.Size = UDim2.new(0, 200, 0, 15)
subtitle.Position = UDim2.new(0, 65, 0, 32)
subtitle.BackgroundTransparency = 1
subtitle.Text = "Secure Verification"
subtitle.TextColor3 = Color3.fromRGB(140, 140, 160)
subtitle.TextSize = 11
subtitle.Font = Enum.Font.Gotham
subtitle.TextXAlignment = Enum.TextXAlignment.Left
subtitle.Parent = titleBar

-- Close Button
local closeBtn = Instance.new("TextButton")
closeBtn.Name = "CloseButton"
closeBtn.Size = UDim2.new(0, 36, 0, 36)
closeBtn.Position = UDim2.new(1, -48, 0, 12)
closeBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 48)
closeBtn.Text = "‚úï"
closeBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
closeBtn.TextSize = 18
closeBtn.Font = Enum.Font.GothamBold
closeBtn.BorderSizePixel = 0
closeBtn.Parent = titleBar

local closeBtnCorner = Instance.new("UICorner")
closeBtnCorner.CornerRadius = UDim.new(0, 8)
closeBtnCorner.Parent = closeBtn

-- Content Frame
local content = Instance.new("Frame")
content.Name = "Content"
content.Size = UDim2.new(1, -50, 1, -100)
content.Position = UDim2.new(0, 25, 0, 75)
content.BackgroundTransparency = 1
content.Parent = mainFrame

-- Status Container with icon
local statusContainer = Instance.new("Frame")
statusContainer.Name = "StatusContainer"
statusContainer.Size = UDim2.new(1, 0, 0, 50)
statusContainer.BackgroundColor3 = Color3.fromRGB(26, 26, 36)
statusContainer.BorderSizePixel = 0
statusContainer.Parent = content

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 10)
statusCorner.Parent = statusContainer

local statusIcon = Instance.new("TextLabel")
statusIcon.Name = "StatusIcon"
statusIcon.Size = UDim2.new(0, 30, 1, 0)
statusIcon.Position = UDim2.new(0, 15, 0, 0)
statusIcon.BackgroundTransparency = 1
statusIcon.Text = "üîë"
statusIcon.TextSize = 20
statusIcon.Parent = statusContainer

local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -60, 1, 0)
statusLabel.Position = UDim2.new(0, 50, 0, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Please get your key to continue"
statusLabel.TextColor3 = Color3.fromRGB(180, 180, 200)
statusLabel.TextSize = 13
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextWrapped = true
statusLabel.TextXAlignment = Enum.TextXAlignment.Left
statusLabel.Parent = statusContainer

-- Key Input Box Container
local inputContainer = Instance.new("Frame")
inputContainer.Name = "InputContainer"
inputContainer.Size = UDim2.new(1, 0, 0, 52)
inputContainer.Position = UDim2.new(0, 0, 0, 65)
inputContainer.BackgroundColor3 = Color3.fromRGB(26, 26, 36)
inputContainer.BorderSizePixel = 0
inputContainer.Parent = content

local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0, 10)
inputCorner.Parent = inputContainer

local inputStroke = Instance.new("UIStroke")
inputStroke.Color = Color3.fromRGB(45, 45, 60)
inputStroke.Thickness = 1.5
inputStroke.Transparency = 0.5
inputStroke.Parent = inputContainer

local keyBox = Instance.new("TextBox")
keyBox.Name = "KeyBox"
keyBox.Size = UDim2.new(1, -24, 1, 0)
keyBox.Position = UDim2.new(0, 12, 0, 0)
keyBox.BackgroundTransparency = 1
keyBox.PlaceholderText = "Enter your key here..."
keyBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 120)
keyBox.Text = ""
keyBox.TextColor3 = Color3.fromRGB(255, 255, 255)
keyBox.TextSize = 14
keyBox.Font = Enum.Font.Gotham
keyBox.ClearTextOnFocus = false
keyBox.TextXAlignment = Enum.TextXAlignment.Left
keyBox.Parent = inputContainer

-- Button Container
local btnContainer = Instance.new("Frame")
btnContainer.Name = "ButtonContainer"
btnContainer.Size = UDim2.new(1, 0, 0, 48)
btnContainer.Position = UDim2.new(0, 0, 0, 135)
btnContainer.BackgroundTransparency = 1
btnContainer.Parent = content

-- Get Key Button
local getKeyBtn = Instance.new("TextButton")
getKeyBtn.Name = "GetKeyButton"
getKeyBtn.Size = UDim2.new(0.48, 0, 1, 0)
getKeyBtn.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
getKeyBtn.Text = ""
getKeyBtn.BorderSizePixel = 0
getKeyBtn.AutoButtonColor = false
getKeyBtn.Parent = btnContainer

local getKeyCorner = Instance.new("UICorner")
getKeyCorner.CornerRadius = UDim.new(0, 10)
getKeyCorner.Parent = getKeyBtn

local getKeyGradient = Instance.new("UIGradient")
getKeyGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 140, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(60, 120, 235))
}
getKeyGradient.Rotation = 90
getKeyGradient.Parent = getKeyBtn

local getKeyText = Instance.new("TextLabel")
getKeyText.Size = UDim2.new(1, 0, 1, 0)
getKeyText.BackgroundTransparency = 1
getKeyText.Text = "üîó Get Key"
getKeyText.TextColor3 = Color3.fromRGB(255, 255, 255)
getKeyText.TextSize = 14
getKeyText.Font = Enum.Font.GothamBold
getKeyText.Parent = getKeyBtn

-- Verify Button
local verifyBtn = Instance.new("TextButton")
verifyBtn.Name = "VerifyButton"
verifyBtn.Size = UDim2.new(0.48, 0, 1, 0)
verifyBtn.Position = UDim2.new(0.52, 0, 0, 0)
verifyBtn.BackgroundColor3 = Color3.fromRGB(60, 200, 120)
verifyBtn.Text = ""
verifyBtn.BorderSizePixel = 0
verifyBtn.AutoButtonColor = false
verifyBtn.Parent = btnContainer

local verifyCorner = Instance.new("UICorner")
verifyCorner.CornerRadius = UDim.new(0, 10)
verifyCorner.Parent = verifyBtn

local verifyGradient = Instance.new("UIGradient")
verifyGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(60, 200, 120)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(40, 180, 100))
}
verifyGradient.Rotation = 90
verifyGradient.Parent = verifyBtn

local verifyText = Instance.new("TextLabel")
verifyText.Size = UDim2.new(1, 0, 1, 0)
verifyText.BackgroundTransparency = 1
verifyText.Text = "‚úì Verify Key"
verifyText.TextColor3 = Color3.fromRGB(255, 255, 255)
verifyText.TextSize = 14
verifyText.Font = Enum.Font.GothamBold
verifyText.Parent = verifyBtn

-- Discord Button
local discordBtn = Instance.new("TextButton")
discordBtn.Name = "DiscordButton"
discordBtn.Size = UDim2.new(1, 0, 0, 40)
discordBtn.Position = UDim2.new(0, 0, 0, 195)
discordBtn.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
discordBtn.Text = ""
discordBtn.BorderSizePixel = 0
discordBtn.AutoButtonColor = false
discordBtn.Parent = content

local discordCorner = Instance.new("UICorner")
discordCorner.CornerRadius = UDim.new(0, 10)
discordCorner.Parent = discordBtn

local discordGradient = Instance.new("UIGradient")
discordGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(88, 101, 242)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(71, 82, 196))
}
discordGradient.Rotation = 90
discordGradient.Parent = discordBtn

local discordText = Instance.new("TextLabel")
discordText.Size = UDim2.new(1, 0, 1, 0)
discordText.BackgroundTransparency = 1
discordText.Text = "üí¨ Join Discord"
discordText.TextColor3 = Color3.fromRGB(255, 255, 255)
discordText.TextSize = 13
discordText.Font = Enum.Font.GothamBold
discordText.Parent = discordBtn

-- Progress Bar Container
local progressContainer = Instance.new("Frame")
progressContainer.Name = "ProgressContainer"
progressContainer.Size = UDim2.new(1, 0, 0, 6)
progressContainer.Position = UDim2.new(0, 0, 0, 248)
progressContainer.BackgroundColor3 = Color3.fromRGB(26, 26, 36)
progressContainer.BorderSizePixel = 0
progressContainer.Parent = content

local progressCorner = Instance.new("UICorner")
progressCorner.CornerRadius = UDim.new(1, 0)
progressCorner.Parent = progressContainer

local progressBar = Instance.new("Frame")
progressBar.Name = "ProgressBar"
progressBar.Size = UDim2.new(0, 0, 1, 0)
progressBar.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
progressBar.BorderSizePixel = 0
progressBar.Parent = progressContainer

local progressBarCorner = Instance.new("UICorner")
progressBarCorner.CornerRadius = UDim.new(1, 0)
progressBarCorner.Parent = progressBar

local progressGradient = Instance.new("UIGradient")
progressGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(80, 140, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(120, 80, 255))
}
progressGradient.Parent = progressBar

-- Footer info
local footer = Instance.new("TextLabel")
footer.Name = "Footer"
footer.Size = UDim2.new(1, 0, 0, 20)
footer.Position = UDim2.new(0, 0, 1, -25)
footer.BackgroundTransparency = 1
footer.Text = "Powered by Platoboost ‚Ä¢ Secure & Fast"
footer.TextColor3 = Color3.fromRGB(80, 80, 100)
footer.TextSize = 10
footer.Font = Enum.Font.Gotham
footer.Parent = content

-- Make draggable
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Enhanced button animations
local function animateButton(button, hover)
    local originalSize = button.Size
    local goal = {}
    
    if hover then
        goal.Size = UDim2.new(originalSize.X.Scale, originalSize.X.Offset, originalSize.Y.Scale, originalSize.Y.Offset + 3)
        goal.BackgroundColor3 = Color3.fromRGB(
            math.min(button.BackgroundColor3.R * 255 + 15, 255),
            math.min(button.BackgroundColor3.G * 255 + 15, 255),
            math.min(button.BackgroundColor3.B * 255 + 15, 255)
        )
    else
        goal.Size = button:GetAttribute("OriginalSize") or originalSize
        goal.BackgroundColor3 = button:GetAttribute("OriginalColor")
    end
    
    TweenService:Create(button, TweenInfo.new(0.2, Enum.EasingStyle.Quad), goal):Play()
end

-- Input box focus animation
keyBox.Focused:Connect(function()
    TweenService:Create(inputStroke, TweenInfo.new(0.3), {
        Color = Color3.fromRGB(80, 140, 255),
        Thickness = 2,
        Transparency = 0
    }):Play()
end)

keyBox.FocusLost:Connect(function()
    TweenService:Create(inputStroke, TweenInfo.new(0.3), {
        Color = Color3.fromRGB(45, 45, 60),
        Thickness = 1.5,
        Transparency = 0.5
    }):Play()
end)

for _, btn in pairs({getKeyBtn, verifyBtn, closeBtn, discordBtn}) do
    btn:SetAttribute("OriginalColor", btn.BackgroundColor3)
    btn:SetAttribute("OriginalSize", btn.Size)
    
    btn.MouseEnter:Connect(function()
        animateButton(btn, true)
    end)
    
    btn.MouseLeave:Connect(function()
        animateButton(btn, false)
    end)
end

-- Update status function with animation
local function updateStatus(message, isError, icon)
    statusLabel.Text = message
    statusIcon.Text = icon or (isError and "‚ùå" or "üîë")
    
    local targetColor = isError and Color3.fromRGB(255, 100, 100) or Color3.fromRGB(180, 180, 200)
    TweenService:Create(statusLabel, TweenInfo.new(0.3), {TextColor3 = targetColor}):Play()
    
    -- Pulse animation
    local originalSize = statusContainer.Size
    TweenService:Create(statusContainer, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
        Size = UDim2.new(originalSize.X.Scale, originalSize.X.Offset + 5, originalSize.Y.Scale, originalSize.Y.Offset + 3)
    }):Play()
    task.wait(0.2)
    TweenService:Create(statusContainer, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
        Size = originalSize
    }):Play()
end

-- Progress animation
local function animateProgress(duration)
    progressBar.Size = UDim2.new(0, 0, 1, 0)
    local tween = TweenService:Create(progressBar, TweenInfo.new(duration, Enum.EasingStyle.Linear), {Size = UDim2.new(1, 0, 1, 0)})
    tween:Play()
    return tween
end

-- Platoboost callback
onMessage = function(message)
    updateStatus(message, false)
end

-- Get Key Button Click
getKeyBtn.MouseButton1Click:Connect(function()
    local success, result = pcall(function()
        return copyLink()
    end)
    
    if success then
        updateStatus("Link copied! Paste in browser to get key", false, "üìã")
        animateProgress(2)
    else
        updateStatus("Failed to copy link", true, "‚ùå")
    end
end)

-- Discord Button Click
discordBtn.MouseButton1Click:Connect(function()
    local discordLink = "https://discord.gg/uqkvDaX3kH"
    
    local success = pcall(function()
        setclipboard(discordLink)
    end)
    
    if success then
        updateStatus("Discord link copied to clipboard!", false, "‚úÖ")
        animateProgress(1.5)
        
        -- Change button text temporarily
        discordText.Text = "‚úì Copied!"
        task.wait(2)
        discordText.Text = "üí¨ Join Discord"
    else
        updateStatus("Failed to copy Discord link", true, "‚ùå")
    end
end)

-- Verify Button Click
verifyBtn.MouseButton1Click:Connect(function()
    local key = keyBox.Text
    
    if key == "" or key == nil then
        updateStatus("Please enter a key first!", true, "‚ö†Ô∏è")
        return
    end
    
    updateStatus("Verifying key...", false, "‚è≥")
    local progressTween = animateProgress(1.5)
    
    task.wait(0.5)
    
    local success, result = pcall(function()
        return verifyKey(key)
    end)
    
    progressTween:Cancel()
    
    if success and result then
        progressBar.Size = UDim2.new(1, 0, 1, 0)
        progressBar.BackgroundColor3 = Color3.fromRGB(60, 200, 120)
        updateStatus("Key verified successfully!", false, "‚úÖ")
        statusLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
        
        task.wait(1.2)
        
        -- Smooth fade out
        TweenService:Create(blur, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
        TweenService:Create(mainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0.5, 0, 0.5, 0)
        }):Play()
        
        task.wait(0.5)
        screenGui:Destroy()
        
        -- Load main script after successful verification
        loadstring([[
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

local character, humanoid, rootPart

local function bindCharacter(char)
	character = char
	humanoid = char:WaitForChild("Humanoid")
	rootPart = char:WaitForChild("HumanoidRootPart")
end

bindCharacter(player.Character or player.CharacterAdded:Wait())
player.CharacterAdded:Connect(bindCharacter)

local remotes = ReplicatedStorage:WaitForChild("Remotes")
local promptPlayerLaunch = remotes:WaitForChild("promptPlayerLaunch")
local topsFolder = workspace:WaitForChild("Tops")

local TARGET_POSITION = Vector3.new(
	415.53619384765625,
	120.1265640258789,
	-86.57369232177734
)

local FACING_POSITION = Vector3.new(
	424.9053955078125,
	112.94845581054688,
	-72.63363647460938
)

local RESPAWN_POSITION = Vector3.new(
	578.4635009765625,
	118.49895477294922,
	-147.76657104492188
)

local POSITION_RADIUS = 3
local MOVE_RATE = 0.15
local ROTATE_SPEED = 10
local RESPAWN_RADIUS = 5
local STUCK_CHECK_INTERVAL = 2
local STUCK_DISTANCE_THRESHOLD = 2
local UNSTUCK_OFFSET_DISTANCE = 8

local isRunning = false
local inPosition = false
local initialFired = false
local lastPosition = nil
local lastMoveTime = 0
local isUnstucking = false
local isRecharging = false
local noclipConnection = nil

local healthConnection = nil
local rotateConnection = nil
local modelConnection = nil
local energyConnection = nil

local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 100)
frame.Position = UDim2.new(0.5, -90, 0.1, 0)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = gui

local button = Instance.new("TextButton")
button.Size = UDim2.new(1, 0, 0, 60)
button.Position = UDim2.new(0, 0, 0, 0)
button.Text = "START"
button.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
button.TextColor3 = Color3.new(1,1,1)
button.Font = Enum.Font.GothamBold
button.TextSize = 18
button.BorderSizePixel = 0
button.Parent = frame

local keyLabel = Instance.new("TextLabel")
keyLabel.Size = UDim2.new(1, 0, 0, 35)
keyLabel.Position = UDim2.new(0, 0, 0, 65)
keyLabel.Text = "Press O to toggle"
keyLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
keyLabel.TextColor3 = Color3.new(1, 1, 1)
keyLabel.Font = Enum.Font.Gotham
keyLabel.TextSize = 14
keyLabel.BorderSizePixel = 0
keyLabel.Parent = frame

local function getCharacter()
	local char = player.Character or player.CharacterAdded:Wait()
	return char, char:WaitForChild("Humanoid")
end

local function getEnergyBar()
	return player.PlayerGui
		:WaitForChild("HUD")
		:WaitForChild("Main HUD")
		:WaitForChild("Energy")
		:WaitForChild("Progress")
end

local function findNearbyProximityPrompt(position, maxDistance)
	local closestPrompt = nil
	local closestDistance = maxDistance
	
	for _, obj in ipairs(workspace:GetDescendants()) do
		if obj:IsA("ProximityPrompt") and obj.Enabled then
			local parent = obj.Parent
			local promptPos = nil
			
			if parent:IsA("BasePart") then
				promptPos = parent.Position
			elseif parent:IsA("Model") then
				if parent.PrimaryPart then
					promptPos = parent.PrimaryPart.Position
				else
					local part = parent:FindFirstChildWhichIsA("BasePart", true)
					if part then
						promptPos = part.Position
					end
				end
			elseif parent:IsA("Attachment") then
				promptPos = parent.WorldPosition
			end
			
			if promptPos then
				local dist = (promptPos - position).Magnitude
				if dist < closestDistance then
					closestDistance = dist
					closestPrompt = obj
				end
			end
		end
	end
	
	return closestPrompt
end

local function fireProximityPrompt(prompt)
	if prompt then
		pcall(function()
			if fireproximityprompt then
				fireproximityprompt(prompt, 0, true)
			elseif fire_proximity_prompt then
				fire_proximity_prompt(prompt)
			else
				local oldHoldDuration = prompt.HoldDuration
				prompt.HoldDuration = 0
				prompt:InputHoldBegin()
				task.wait(0.1)
				prompt:InputHoldEnd()
				prompt.HoldDuration = oldHoldDuration
			end
		end)
	end
end

local function startEnergyMonitoring()
	if energyConnection then
		task.cancel(energyConnection)
	end
	
	energyConnection = task.spawn(function()
		local energyBar = getEnergyBar()
		while isRunning do
			local energy = energyBar.Size.X.Scale
			if energy <= 0 then
				isRecharging = true
				
				local reachedPosition = false
				local maxAttempts = 60
				
				for i = 1, maxAttempts do
					local _, hum = getCharacter()
					local char = player.Character
					
					if char and char:FindFirstChild("HumanoidRootPart") then
						local dist = (char.HumanoidRootPart.Position - RESPAWN_POSITION).Magnitude
						
						if dist <= RESPAWN_RADIUS then
							reachedPosition = true
							break
						else
							hum:MoveTo(RESPAWN_POSITION)
						end
					end
					
					task.wait(0.5)
				end
				
				if reachedPosition then
					task.wait(2)
					
					local char = player.Character
					if char and char:FindFirstChild("HumanoidRootPart") then
						local prompt = findNearbyProximityPrompt(RESPAWN_POSITION, 15)
						if prompt then
							print("Found proximity prompt, firing...")
							fireProximityPrompt(prompt)
							task.wait(2)
						else
							print("No proximity prompt found near respawn position")
						end
					end
				else
					print("Failed to reach respawn position")
				end
				
				isRecharging = false
			end
			task.wait(10)
		end
	end)
end

local function startFacing()
	if rotateConnection then rotateConnection:Disconnect() end

	rotateConnection = RunService.RenderStepped:Connect(function(dt)
		if not isRunning or not rootPart or isRecharging then return end

		local dir = FACING_POSITION - rootPart.Position
		local flat = Vector3.new(dir.X, 0, dir.Z)
		if flat.Magnitude == 0 then return end

		local targetCF = CFrame.new(rootPart.Position, rootPart.Position + flat)
		local alpha = 1 - math.exp(-ROTATE_SPEED * dt)

		rootPart.CFrame = rootPart.CFrame:Lerp(targetCF, alpha)
	end)
end

local function stopFacing()
	if rotateConnection then
		rotateConnection:Disconnect()
		rotateConnection = nil
	end
end

local function startNoclip()
	if noclipConnection then
		noclipConnection:Disconnect()
	end
	
	noclipConnection = RunService.Stepped:Connect(function()
		if character then
			for _, part in pairs(character:GetDescendants()) do
				if part:IsA("BasePart") then
					part.CanCollide = false
				end
			end
		end
	end)
end

local function stopNoclip()
	if noclipConnection then
		noclipConnection:Disconnect()
		noclipConnection = nil
	end
	
	if character then
		for _, part in pairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = true
			end
		end
	end
end

local function startHealthMonitor(model)
	if healthConnection then
		healthConnection:Disconnect()
	end

	local firedLow = false
	local firedZero = false

	local function checkHealth()
		if not isRunning then return end

		local health = model:GetAttribute("Health")
		if not health then return end

		if inPosition and health < 80 and not firedLow then
			firedLow = true
			promptPlayerLaunch:FireServer(1, player.Character)
		end

		if health == 0 and not firedZero then
			firedZero = true
			promptPlayerLaunch:FireServer(1, player.Character)
		end

		if health >= 80 then
			firedLow = false
		end

		if health > 0 then
			firedZero = false
		end

		if not inPosition then
			firedLow = false
		end
	end

	checkHealth()
	healthConnection = model:GetAttributeChangedSignal("Health"):Connect(checkHealth)
end

local function watchModels()
	if modelConnection then
		modelConnection:Disconnect()
	end

	local id = tostring(player.UserId)

	local existing = topsFolder:FindFirstChild(id)
	if existing then
		startHealthMonitor(existing)
	end

	modelConnection = topsFolder.ChildAdded:Connect(function(child)
		if child.Name == id then
			startHealthMonitor(child)
		end
	end)
end

local function startMovement()
	task.spawn(function()
		while isRunning do
			if humanoid and rootPart and not isUnstucking and not isRecharging then
				local dist = (rootPart.Position - TARGET_POSITION).Magnitude

				if dist > POSITION_RADIUS then
					inPosition = false
					humanoid:MoveTo(TARGET_POSITION)
				else
					inPosition = true

					if not initialFired then
						initialFired = true
						promptPlayerLaunch:FireServer(1, player.Character)
					end
				end
			end
			task.wait(MOVE_RATE)
		end
	end)
	
	task.spawn(function()
		while isRunning do
			task.wait(STUCK_CHECK_INTERVAL)
			
			if rootPart and humanoid and not isUnstucking and not isRecharging then
				local currentPos = rootPart.Position
				local currentTime = tick()
				
				if lastPosition then
					local distMoved = (currentPos - lastPosition).Magnitude
					local timeDiff = currentTime - lastMoveTime
					
					if distMoved < STUCK_DISTANCE_THRESHOLD and timeDiff >= STUCK_CHECK_INTERVAL then
						local distToTarget = (currentPos - TARGET_POSITION).Magnitude
						
						if distToTarget > POSITION_RADIUS then
							isUnstucking = true
							
							humanoid:Move(Vector3.new(0, 0, 0))
							task.wait(0.1)
							
							local dirToTarget = (TARGET_POSITION - currentPos).Unit
							local rightVector = Vector3.new(-dirToTarget.Z, 0, dirToTarget.X)
							local leftVector = Vector3.new(dirToTarget.Z, 0, -dirToTarget.X)
							local sideVector = math.random() > 0.5 and rightVector or leftVector
							local sidePosition = currentPos + (sideVector * UNSTUCK_OFFSET_DISTANCE)
							
							humanoid:MoveTo(sidePosition)
							task.wait(1.5)
							
							isUnstucking = false
						end
					end
				end
				
				lastPosition = currentPos
				lastMoveTime = currentTime
			end
		end
	end)
end

local function start()
	if isRunning then return end
	isRunning = true

	button.Text = "STOP"
	button.BackgroundColor3 = Color3.fromRGB(40, 167, 69)

	startFacing()
	startMovement()
	watchModels()
	startEnergyMonitoring()
	startNoclip()
end

local function stop()
	isRunning = false

	button.Text = "START"
	button.BackgroundColor3 = Color3.fromRGB(220, 53, 69)

	stopFacing()
	stopNoclip()
	
	lastPosition = nil
	lastMoveTime = 0
	isUnstucking = false
	isRecharging = false

	if healthConnection then
		healthConnection:Disconnect()
		healthConnection = nil
	end

	if modelConnection then
		modelConnection:Disconnect()
		modelConnection = nil
	end
	
	if energyConnection then
		task.cancel(energyConnection)
		energyConnection = nil
	end
end

button.MouseButton1Click:Connect(function()
	if isRunning then
		stop()
	else
		start()
	end
end)

UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	
	if input.KeyCode == Enum.KeyCode.O then
		if isRunning then
			stop()
		else
			start()
		end
	end
end)
]])()
    else
        progressBar.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
        TweenService:Create(progressBar, TweenInfo.new(0.3), {Size = UDim2.new(1, 0, 1, 0)}):Play()
        updateStatus("Invalid key! Please try again", true, "‚ùå")
        task.wait(0.5)
        progressBar.Size = UDim2.new(0, 0, 1, 0)
        progressBar.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
    end
end)

-- Close button
closeBtn.MouseButton1Click:Connect(function()
    TweenService:Create(blur, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
    TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0)
    }):Play()
    task.wait(0.3)
    screenGui:Destroy()
end)

-- Initial entrance animation
mainFrame.Size = UDim2.new(0, 0, 0, 0)
mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
blur.BackgroundTransparency = 1

TweenService:Create(blur, TweenInfo.new(0.4), {BackgroundTransparency = 0.5}):Play()

local openTween = TweenService:Create(mainFrame, TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Size = UDim2.new(0, 480, 0, 340),
    Position = UDim2.new(0.5, -240, 0.5, -170)
})
openTween:Play()

-- Animate gradient
spawn(function()
    while screenGui.Parent do
        TweenService:Create(accentGradient, TweenInfo.new(3, Enum.EasingStyle.Linear), {Offset = Vector2.new(1, 0)}):Play()
        task.wait(3)
        accentGradient.Offset = Vector2.new(-1, 0)
    end
end)
